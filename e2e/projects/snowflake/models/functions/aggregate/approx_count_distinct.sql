WITH SALES_DATA AS (
    SELECT 1 AS CUSTOMER_ID, '2022-01-02' AS PURCHASE_DATE
    UNION ALL
    SELECT 1, '2022-01-05'
    UNION ALL
    SELECT 2, '2022-01-07'
    UNION ALL
    SELECT 3, '2022-01-10'
    UNION ALL
    SELECT 3, '2022-01-12'
    UNION ALL
    SELECT 4, '2022-02-01'
    UNION ALL
    SELECT 4, '2022-02-03'
    UNION ALL
    SELECT 5, '2022-02-04'
    UNION ALL
    SELECT 6, '2022-02-08'
)
-- QUERY USING APPROX_COUNT_DISTINCT FUNCTION
SELECT APPROX_COUNT_DISTINCT(DISTINCT CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM SALES_DATA
